<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Stopwatch</title>
    <link rel="stylesheet" href="style.css">
    <script src="stopwatch.js"></script>
</head>
<body>
<div class="container">
    <div class="title">Meeting Stopwatch</div>
    <div class="stopwatch" id="time">--:--:--</div>
    <button id='btnNext' onclick="onBtnNext()" title="Hotkey: N">Next Participant</button>
    <button id='btnPauseResume' onclick="onBtnPauseResume()" title="Hotkey: Spacebar">Pause&nbsp;</button>
    <div class="statistic">Average Time: <span id="list-mean">-</span></div>
    <div class="statistic">Median Time: <span id="list-median">-</span></div>
    <div class="statistic">Participants: <span id="participants">-</span></div>
    <noscript>This page requires JavaScript in order to work. Sorry.</noscript>
</div>
<script>
    let elemTime = document.getElementById('time');
    let elemListMean = document.getElementById('list-mean');
    let elemListMedian = document.getElementById('list-median');
    let elemParticipants = document.getElementById('participants');
    let btnPauseResume = document.getElementById('btnPauseResume');

    let stopwatch = new Stopwatch((timestamp) => {
        elemTime.innerText = timestamp;
    });

    let timeList = new TimeList();

    function onBtnNext() {
        if (stopwatch.timestamp.seconds === 0) {
            // It makes no sense to "store" this timestamp
            return;
        }

        timeList.push(stopwatch.timestamp.clone())
        stopwatch.reset();
        elemListMean.innerText = timeList.mean().toString();
        elemListMedian.innerText = timeList.median().toString();
        elemParticipants.innerText = timeList.count.toString();
    }
    function onBtnPauseResume() {
        if (stopwatch.running) {
            stopwatch.pause();
            btnPauseResume.innerHTML = 'Resume';
            elemTime.classList.add('paused');
        } else {
            stopwatch.resume();
            btnPauseResume.innerHTML = 'Pause&nbsp;';
            elemTime.classList.remove('paused');
        }
    }

    // Hotkeys
    document.body.onkeyup = function(e) {
        if (e.key === ' ' || e.code === 'Space') {
            onBtnPauseResume();
        } else if (e.key === 'n') {
            onBtnNext();
        }
        return false;
    }
</script>
</body>
</html>